<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>H·ªá Th·ªëng ƒêi·ªÅu Khi·ªÉn Trang Tr·∫°i B√≤ Th√¥ng Minh</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://unpkg.com/mqtt/dist/mqtt.min.js"></script>
    <link rel="stylesheet" href="subscriber.css">
</head>
<body>
    <div class="dashboard">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <div class="farm-logo">
                    <div class="cow-icon">üêÆ</div>
                    <h1>H·ªÜ TH·ªêNG ƒêI·ªÄU KHI·ªÇN<br>TRANG TR·∫†I B√í TH√îNG MINH</h1>
                </div>
                <div class="connection-status" id="connectionStatus">
                    <div class="status-indicator"></div>
                    <span>ƒêANG K·∫æT N·ªêI...</span>
                </div>
            </div>
        </header>

        <!-- Topic Configuration -->
        <div class="config-section">
            <div class="config-card">
                <h3>‚öôÔ∏è C·∫§U H√åNH K·∫æT N·ªêI MQTT</h3>
                <div class="config-row">
                    <input
                        type="text"
                        id="topic"
                        placeholder="Nh·∫≠p topic MQTT (v√≠ d·ª•: PBL3)"
                        value="PBL3"
                    />
                    <button id="subscribeBtn">Theo d√µi</button>
                    <button id="unsubscribeBtn">D·ª´ng theo d√µi</button>
                </div>
            </div>
        </div>

        <!-- Main Dashboard - Gi√°m s√°t, ƒêi·ªÅu khi·ªÉn v√† Tr·∫°ng th√°i -->
        <div class="status-grid">
            <!-- Gi√°m s√°t M√¥i tr∆∞·ªùng -->
            <div class="status-card temperature-card">
                <div class="card-header">
                    <h3>üå°Ô∏è NHI·ªÜT ƒê·ªò</h3>
                    <div class="gauge">
                        <div class="gauge-fill" id="tempGauge"></div>
                        <div class="gauge-value" id="temperature">-- ¬∞C</div>
                    </div>
                    <div class="sensor-info">C·∫£m bi·∫øn DHT22 - C·∫≠p nh·∫≠t th·ªùi gian th·ª±c</div>
                    <div class="notification-display" id="temperatureNotification">
                        ƒêang ch·ªù d·ªØ li·ªáu t·ª´ c·∫£m bi·∫øn...
                    </div>
                </div>
            </div>

            <div class="status-card humidity-card">
                <div class="card-header">
                    <h3>üíß ƒê·ªò ·∫®M</h3>
                    <div class="gauge">
                        <div class="gauge-fill" id="humGauge"></div>
                        <div class="gauge-value" id="humidity">-- %</div>
                    </div>
                    <div class="sensor-info">C·∫£m bi·∫øn DHT22 - C·∫≠p nh·∫≠t th·ªùi gian th·ª±c</div>
                </div>
            </div>

            <div class="status-card gas-alarm-card">
                <div class="card-header">
                    <h3>‚ö†Ô∏è KH√ç GAS</h3>
                    <div class="alarm-status" id="gasAlarmStatus">
                        <div class="alarm-indicator" id="gasAlarmIndicator">AN TO√ÄN</div>
                        <div class="gas-level">
                            <div class="gauge">
                                <div class="gauge-fill" id="gasGauge"></div>
                                <div class="gauge-value" id="gasLevel">--</div>
                            </div>
                            <div class="gas-label">C·∫£m bi·∫øn MQ - C·∫≠p nh·∫≠t th·ªùi gian th·ª±c</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Tr·∫°ng th√°i Thi·∫øt b·ªã -->
            <div class="status-card led-card">
                <div class="card-header">
                    <h3>üí° ƒê√àN CHI·∫æU S√ÅNG</h3>
                    <div class="device-status">
                        <div class="led-display" id="ledStatus">T·∫ÆT</div>
                        <div class="device-info">ƒê√®n chi·∫øu s√°ng khu v·ª±c chu·ªìng tr·∫°i</div>
                    </div>
                </div>
            </div>

            <div class="status-card fan-card">
                <div class="card-header">
                    <h3>üåÄ QU·∫†T TH√îNG GI√ì</h3>
                    <div class="device-status">
                        <div class="fan-display" id="fanStatus">T·∫ÆT</div>
                        <div class="auto-status" id="fanAutoStatus"></div>
                        <div class="device-info">T·ª± ƒë·ªông b·∫≠t khi nhi·ªát ƒë·ªô > 40¬∞C</div>
                    </div>
                </div>
            </div>

            <div class="status-card pump-card">
                <div class="card-header">
                    <h3>üö∞ B∆†M N∆Ø·ªöC U·ªêNG</h3>
                    <div class="device-status">
                        <div class="pump-display" id="pumpStatus">T·∫ÆT</div>
                        <div class="auto-status" id="pumpAutoStatus"></div>
                        <div class="device-info">T·ª± ƒë·ªông b·∫≠t khi ph√°t hi·ªán kh√≠ gas</div>
                    </div>
                </div>
            </div>

            <!-- ƒêi·ªÅu khi·ªÉn Thi·∫øt b·ªã -->
            <div class="status-card control-card">
                <div class="card-header">
                    <h3>üéõÔ∏è ƒêI·ªÄU KHI·ªÇN THI·∫æT B·ªä</h3>

                    <!-- Hi·ªÉn th·ªã tr·∫°ng th√°i th·ªùi gian th·ª±c -->
                    <div class="real-time-status">
                        <h4>TR·∫†NG TH√ÅI TH·ªúI GIAN TH·ª∞C</h4>
                        <div class="status-indicators">
                            <div class="status-item">
                                <span class="status-label">üí° ƒê√®n:</span>
                                <span class="status-value" id="ledRealTime">T·∫ÆT</span>
                            </div>
                            <div class="status-item">
                                <span class="status-label">üåÄ Qu·∫°t:</span>
                                <span class="status-value" id="fanRealTime">T·∫ÆT</span>
                            </div>
                            <div class="status-item">
                                <span class="status-label">üö∞ B∆°m:</span>
                                <span class="status-value" id="pumpRealTime">T·∫ÆT</span>
                            </div>
                            <div class="status-item">
                                <span class="status-label">üîä C√≤i:</span>
                                <span class="status-value" id="buzzerRealTime">T·∫ÆT</span>
                            </div>
                        </div>
                    </div>

                    <div class="control-switches">
                        <div class="switch-group">
                            <label>üí° ƒê√®n chi·∫øu s√°ng</label>
                            <label class="switch">
                                <input type="checkbox" id="lightSwitch" />
                                <span class="slider round"></span>
                            </label>
                        </div>
                        <div class="switch-group">
                            <label>üåÄ Qu·∫°t th√¥ng gi√≥</label>
                            <label class="switch">
                                <input type="checkbox" id="fanSwitch" />
                                <span class="slider round"></span>
                            </label>
                        </div>
                        <div class="switch-group">
                            <label>üö∞ B∆°m n∆∞·ªõc u·ªëng</label>
                            <label class="switch">
                                <input type="checkbox" id="pumpSwitch" />
                                <span class="slider round"></span>
                            </label>
                        </div>
                        <div class="switch-group">
                            <label>üîä C√≤i b√°o ƒë·ªông</label>
                            <label class="switch">
                                <input type="checkbox" id="buzzerSwitch" />
                                <span class="slider round"></span>
                            </label>
                        </div>
                    </div>

                    <!-- N√∫t ƒëi·ªÅu khi·ªÉn nhanh -->
                    <div class="quick-controls">
                        <button class="control-btn all-on" id="allOnBtn">B·∫¨T T·∫§T C·∫¢</button>
                        <button class="control-btn all-off" id="allOffBtn">T·∫ÆT T·∫§T C·∫¢</button>
                    </div>
                </div>
            </div>

            <!-- H·ªá th·ªëng C·∫£nh b√°o -->
            <div class="status-card fire-alarm-card">
                <div class="card-header">
                    <h3>üö® H·ªÜ TH·ªêNG C·∫¢NH B√ÅO T·ª∞ ƒê·ªòNG</h3>
                    <div class="alarm-status" id="alarmStatus">
                        <div class="alarm-indicator" id="alarmIndicator">B√åNH TH∆Ø·ªúNG</div>
                        <div class="alarm-info">
                            <p>‚Ä¢ T·ª± ƒë·ªông b·∫≠t QU·∫†T khi nhi·ªát ƒë·ªô > 40¬∞C</p>
                            <p>‚Ä¢ T·ª± ƒë·ªông b·∫≠t B∆†M + C√íI khi c√≥ kh√≠ gas</p>
                            <p>‚Ä¢ C·∫£nh b√°o khi ph√°t hi·ªán nhi·ªát ƒë·ªô nguy hi·ªÉm</p>
                        </div>
                        <div class="alarm-buttons">
                            <button class="test-alarm-btn" id="testAlarmBtn">Ki·ªÉm tra c√≤i</button>
                            <button class="silence-alarm-btn" id="silenceAlarmBtn">T·∫Øt √¢m thanh</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Bi·ªÉu ƒë·ªì theo d√µi -->
        <div class="charts-section">
            <div class="chart-card">
                <h3>üìà DI·ªÑN BI·∫æN NHI·ªÜT ƒê·ªò THEO TH·ªúI GIAN TH·ª∞C</h3>
                <canvas id="temperatureChart"></canvas>
            </div>
            <div class="chart-card">
                <h3>üìä DI·ªÑN BI·∫æN ƒê·ªò ·∫®M THEO TH·ªúI GIAN TH·ª∞C</h3>
                <canvas id="humidityChart"></canvas>
            </div>
        </div>

        <!-- L·ªãch s·ª≠ th√¥ng b√°o -->
        <div class="history-section">
            <div class="history-card">
                <h3>üìù NH·∫¨T K√ù H·ªÜ TH·ªêNG TH·ªúI GIAN TH·ª∞C</h3>
                <div class="message-list" id="messageHistory">
                    <div class="message-item">
                        <span class="timestamp" id="currentTime">--:--:-- --/--/----</span>
                        <span class="message">H·ªá th·ªëng ƒëi·ªÅu khi·ªÉn trang tr·∫°i b√≤ ƒë√£ kh·ªüi ƒë·ªông. ƒêang k·∫øt n·ªëi c·∫£m bi·∫øn...</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Th√¥ng b√°o ph·∫£n h·ªìi -->
    <div class="control-feedback" id="controlFeedback"></div>

    <script src="subscriber.js"></script>
</body>
</html>